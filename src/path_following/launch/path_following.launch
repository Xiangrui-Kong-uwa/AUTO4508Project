<launch>
  <!-- node for start joystick control -->
  <include file="$(find joy)/launch/ps3joy.launch"></include>
  <!-- node for imu -->
  <include file="$(find phidgets_spatial)/launch/spatial.launch"></include>

  <!-- node for GPS, TODO: test outside -->
  <node name="nmea_serial_driver_node" pkg="nmea_navsat_driver" type="nmea_serial_driver" output="screen">
    <param name="port" value="/dev/ttyACM0"/>
    <param name="baud" value="9600" />
    <param name="frame_id" value="gps" />
    <param name="use_GNSS_time" value="False" />
    <param name="time_ref_source" value="gps" />
    <param name="useRMC" value="False" />
  </node>


	<node pkg = "rosaria" type = "RosAria" name = "RosAria">
		<param name="port" value="/dev/ttyS1" type="string"/>
	</node>
  <!-- depthai-ros for camera -->
  <!-- <args for urdf/> -->
  <arg name="camera_model"      default="OAK-D" /> <!-- 'zed' or 'zedm' -->
  <arg name="tf_prefix"         default="oak" />
  <arg name="mode"              default="depth" />
  <arg name="base_frame"        default="oak-d_frame" />
  <arg name="parent_frame"      default="oak-d-base-frame" />

  <arg name="cam_pos_x"         default="0.0" /> <!-- Position respect to base frame (i.e. "base_link) -->
  <arg name="cam_pos_y"         default="0.0" /> <!-- Position respect to base frame (i.e. "base_link) -->
  <arg name="cam_pos_z"         default="0.0" /> <!-- Position respect to base frame (i.e. "base_link) -->
  <arg name="cam_roll"          default="0.0" /> <!-- Orientation respect to base frame (i.e. "base_link) -->
  <arg name="cam_pitch"         default="0.0" /> <!-- Orientation respect to base frame (i.e. "base_link) -->
  <arg name="cam_yaw"           default="0.0" /> <!-- Orientation respect to base frame (i.e. "base_link) -->
  
  <arg name="confidence"        default="200" /> 
  <arg name="LRchecktresh"      default="5" /> 
  <arg name="lrcheck"           default="true" /> 
  <arg name="extended"          default="false" /> 
  <arg name="subpixel"          default="true" />
  <arg name="monoResolution"    default="720p" /> 
  <arg name="camera_param_uri"  default="package://depthai_examples/params/camera" />

  <include file="$(find depthai_descriptions)/launch/urdf.launch">
      <arg name="base_frame"      value="$(arg  base_frame)"  />
      <arg name="parent_frame"    value="$(arg  parent_frame)"/>
      <arg name="camera_model"    value="$(arg  camera_model)"/>
      <arg name="tf_prefix"       value="$(arg  tf_prefix)" />
      <arg name="cam_pos_x"       value="$(arg  cam_pos_x)"   />
      <arg name="cam_pos_y"       value="$(arg  cam_pos_y)"   />
      <arg name="cam_pos_z"       value="$(arg  cam_pos_z)"   />
      <arg name="cam_roll"        value="$(arg  cam_roll)"    />
      <arg name="cam_pitch"       value="$(arg  cam_pitch)"   />
      <arg name="cam_yaw"         value="$(arg  cam_yaw)"     />
  </include>

  <!-- launch-prefix="xterm -e gdb (add [- - args] without space) -->
  <node name="stereo_publisher" pkg="depthai_examples" type="stereo_node" output="screen" required="true">
      <param name="tf_prefix"        value="$(arg tf_prefix)"/>
      <param name="camera_param_uri" value="$(arg camera_param_uri)"/>
      <param name="mode"             value="$(arg mode)"/>
      <param name="lrcheck"          value="$(arg lrcheck)"/>
      <param name="extended"         value="$(arg extended)"/>
      <param name="subpixel"         value="$(arg subpixel)"/>
      <param name="confidence"       value="$(arg confidence)"/>
      <param name="LRchecktresh"     value="$(arg LRchecktresh)"/>
      <param name="monoResolution"   value="$(arg monoResolution)"/>
  </node>            
  
  <!-- node for lidar -->
  <include file="$(find sick_scan)/launch/sick_tim_7xx.launch"></include>  

  <node type="rviz" name="rviz" pkg="rviz" args="-d $(find depthai_examples)/rviz/stereoPointCloud_v1.rviz" />
  <!-- <include file="$(find depthai_examples)/launch/stereo_node.launch"> -->
  <node pkg="path_following" type="path_following.py" name="path_following" output="screen">
    <param name="file_path" type="str" value="$(find path_following)/path_points.txt" />
  </node>
  <!-- photo_taking node, save cone and objects  -->
  <node pkg="photo_taking" type="photo_taking.py" name="photo_taking" output="screen">
    <param name="file_path" type="str" value="$(find photo_taking)" />
  </node>
  <node pkg="record_display" type="record_display.py" name="record_display" output="screen"/>
  <!-- TODO: add a back moving control -->
  <node pkg="remote_control" type="remote_control.py" name="remote_control" output="screen"/>
</launch> 
